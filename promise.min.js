!function(a,b){"use strict";"undefined"==typeof a.Promise&&(a.Promise=function(){function e(a){return null!==a&&"function"==typeof a}function g(a){return null!==a&&"object"==typeof a&&"undefined"!==a._promiseState}function h(a,b){this._capabilities=a,this._handler=b}function i(a,b,c){this._promise=a,this._resolve=b,this._reject=c}function k(){var b=a.setImmediate&&a.setImmediate.bind(a),c=a.clearImmediate&&a.clearImmediate.bind(a);j.call(this,b,c)}function l(){function h(b){if(b.source===a&&"string"==typeof b.data&&0===b.data.indexOf(g)){handle=+b.data.slice(g.length);var c=f[handle];if(c)try{c()}finally{d(handle)}}}var c,d;if(a.postMessage&&!a.importScripts){var e=1,f={},g="setImmediate$"+Math.random()+"$";c=function(c){var d=Array.prototype.slice.call(arguments,1);f[e]=function(){"function"==typeof c?c.apply(b,d):new Function(""+c)()};var h=e++;return a.postMessage(g+h,"*"),h},d=function(a){delete f[a]},a.addEventListener?a.addEventListener("message",h,!1):a.attachEvent("onmessage",h)}j.call(this,c,d)}function m(){var b=a.msSetImmediate&&a.msSetImmediate.bind(a),c=a.msClearImmediate&&a.msClearImmediate.bind(a);j.call(this,b,c)}function n(){var b=a.setTimeout&&a.setTimeout.bind(a),c=a.clearTimeout&&a.clearTimeout.bind(a);j.call(this,b,c)}function q(a,c){if(a instanceof h){var e=a._capabilities,f=a._handler,g=null,i=null;try{g=f===d.identity?c:f.call(b,c),i=e._resolve(g)}catch(j){i=e._reject.call(b,j)}}}function r(a,b,f,g){e(b)||(b=d.identity),e(f)||(f=d.thrower);var i=new h(g,b),j=new h(g,f);if(a._promiseState===c.pending)a._promiseFulfillReactions.push(i),a._promiseRejectReactions.push(j);else if(a._promiseState===c.fulfilled){var k=a._promiseResult;p.enqueue("PromiseJobs",q,[i,k])}else if(a._promiseState===c.rejected){var l=a._promiseResult;p.enqueue("PromiseJobs",q,[j,l])}return g._promise}function s(a){function b(a,c){var d=b._capability;if(d instanceof i){if("undefined"!=typeof d._resolve)throw new TypeError;if("undefined"!=typeof d._reject)throw new TypeError;d._resolve=a,d._reject=c}}return b._capability=a,b}function t(a){var b=new i,c=s(b),d=new a(c);if(!e(b._resolve))throw new TypeError;if(!e(b._reject))throw new TypeError;return b._promise=d,b}function u(a,c,d){var e=A(a);try{var f=d.call(c,[e._resolve,e._reject])}catch(g){e._reject.call(b,f)}}function v(a,c){for(var d=0,e=a.length;e>d;d++)p.enqueue("PromiseJobs",q,[a[d],c]);return b}function w(a,d){var e=a._promiseFulfillReactions;return a._promiseResult=d,a._promiseFulfillReactions=b,a._promiseRejectReactions=b,a._promiseState=c.fulfilled,v(e,d)}function x(a,d){var e=a._promiseRejectReactions;return a._promiseResult=d,a._promiseFulfillReactions=b,a._promiseRejectReactions=b,a._promiseState=c.rejected,v(e,d)}function y(a,c){var d=function(a){var c=d._promise,f=d._alreadyResolved;if(f._value)return b;if(f._value=!0,a===c)return x(c,new TypeError);if("object"!=typeof a)return w(c,a);var g=a.then;return"undefined"==typeof g?x(c,g):e(g)?(p.enqueue("PromiseJobs",u,[c,a,g]),b):w(c,g)};return d._promise=a,d._alreadyResolved=c,d}function z(a,c){var d=function(a){var c=d._promise,e=d._alreadyResolved;return e._value?b:(e._value=!0,x(c,a))};return d._promise=a,d._alreadyResolved=c,d}function A(a){var b={_value:!1},c=y(a,b),d=z(a,b);return{_resolve:c,_reject:d}}function B(a){if("function"!=typeof a)throw new TypeError("Promise resolver must be function");this._promiseState=c.pending,this._promiseResult=b,this._promiseFulfillReactions=[],this._promiseRejectReactions=[];var d=A(this);try{var e=a.call(b,d._resolve,d._reject)}catch(f){d._reject.call(b,e)}}var c={pending:"pending",fulfilled:"fulfilled",rejected:"rejected"},d={identity:function(a){return a},thrower:function(a){throw a}},j=function(a){function b(a,b,c){this.name=a,this.action=b,this.args=c}function c(a,b,c){"undefined"===c&&(c=100),this._run=a,this._clear=b,this._queue=new Array(c),this._queueIds=new Array(c),this._length=0}return b.prototype.execute=function(){this.action.apply(a,this.args)},c.prototype.isSupported=function(){return"undefined"!=typeof this._queue&&"undefined"!=typeof this._run&&"undefined"!=typeof this._clear},c.prototype.enqueue=function(a,c,d){if(!this.isSupported())throw new TypeError;if("function"!=typeof c)throw new TypeError("Unexpected action value. Expected type: function");if(null!=typeof d&&("object"!=typeof d||"undefined"==typeof d.length))throw new TypeError("Unexpected args value. Expected type: Array, null or undefined");this._queue[this._length]=new b(a,c,d),this._queueIds[this._length++]=this._run(this._process.bind(this),0)},c.prototype._process=function(){for(var a=0;a<this._length;a++)this._execute(a),this._remove(a);this._length=0},c.prototype._execute=function(a){this._queue[a].execute()},c.prototype._remove=function(b){this._clear(this._queueIds[b]),this._queue[b]=a,this._queueIds[b]=a},c}();k.prototype=Object.create(j.prototype),l.prototype=Object.create(j.prototype),m.prototype=Object.create(j.prototype),n.prototype=Object.create(j.prototype);var o=function(){function a(){this._handlers=[k,m,l,n]}return a.prototype.createJobHandler=function(){for(var b,a=this._handlers.length,c=0;a>c;c++){var b=new this._handlers[c];if(b.isSupported())return b}throw new Error("No job handler supported.")},new a}(),p=o.createJobHandler();return B.prototype["catch"]=function(a){return B.prototype.then.call(this,null,a)},B.prototype.then=function(a,b){var c=this;if(!g(c))throw new TypeError("Invalid operation on a promise function");var d=c.constructor,e=t(d);return r(c,a,b,e)},B.all=function(a){throw new Error("Not Implemented")},B.race=function(a){throw new Error("Not Implemented")},B.reject=function(a){throw new Error("Not Implemented")},B.resolve=function(){throw new Error("Not Implemented")},B}())}(window);