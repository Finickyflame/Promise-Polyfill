/*
 * Promise-Polyfill
 * (c) Nicholas Berube - https://github.com/Finickyflame/Promise-Polyfill/
 * License: MIT (http://www.opensource.org/licenses/mit-license.php)
 */
!function(e,t){"use strict";if("function"!=typeof Object.create&&(Object.create=function(){var e=function(){};return function(t){if(arguments.length>1)throw Error("Second argument not supported");if(t!==Object(t)&&null!==t)throw TypeError("Argument must be an object or null");if(null===t)throw Error("null [[Prototype]] not supported");e.prototype=t;var r=new e;return e.prototype=null,r}}()),"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=this,r=Array.prototype.slice.call(arguments,1),n=function(){},i=function(){t.apply(this instanceof n?this:e,r.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(n.prototype=this.prototype),i.prototype=new n,i}),"undefined"==typeof e.Promise||e.debugPromise){var n=function(){function e(e,t){this._capabilities=e,this._handler=t}function n(e,t,r){this._promise=e,this._resolve=t,this._reject=r}function i(e){this._iterator=e,this._done=!1}function o(e,r,n,i,o){var u=function(e){var r=u._alreadyCalled;if(r._value)return t;r._value=!0;var n=u._index,i=u._values,o=u._capabilities,a=u._remainingElements;return i[n]=e,a._value=a._value-1,0==a._value?o._resolve(i):t};return u._alreadyCalled=e,u._index=r,u._values=n,u._capabilities=i,u._remainingElements=o,u}function u(e,r){var n=function(e){var r=n._promise,i=n._alreadyResolved;return i._value?t:(i._value=!0,b(r,e))};return n._promise=e,n._alreadyResolved=r,n}function a(e,r){var n=function(e){var r=n._promise,i=n._alreadyResolved;if(i._value)return t;if(i._value=!0,e===r)return b(r,new TypeError);if("object"!=typeof e)return c(r,e);var o;try{o=e.then}catch(u){return b(r,o)}return f(o)?(T.enqueue("PromiseJobs",m,[r,e,o]),t):c(r,e)};return n._promise=e,n._alreadyResolved=r,n}function s(e){var t={_value:!1},r=a(e,t),n=u(e,t);return{_resolve:r,_reject:n}}function c(e,r){var n=e._promiseFulfillReactions;return e._promiseResult=r,e._promiseFulfillReactions=t,e._promiseRejectReactions=t,e._promiseState=R.fulfilled,g(n,r)}function l(e){function t(e,r){var i=t._capability;if(i instanceof n){if("undefined"!=typeof i._resolve)throw new TypeError;if("undefined"!=typeof i._reject)throw new TypeError;i._resolve=e,i._reject=r}}return t._capability=e,t}function p(e,r){try{e()}catch(n){try{var i=r._reject.call(t,n);return i}catch(o){return r._promise}}}function f(e){return null!==e&&"function"==typeof e}function d(e){return null!==e&&"object"==typeof e&&"undefined"!==e._promiseState}function _(e){var t=new n,r=l(t),i=new e(r);if(!f(t._resolve))throw new TypeError;if(!f(t._reject))throw new TypeError;return t._promise=i,t}function h(e,r,n){for(var i=[],u={_value:1},a=0;e._iterator.next();){var s=e._iterator.getCurrent();i.push(t);var c=r.resolve(s),l=o({_value:!1},a,i,n,u);u._value=u._value+1;c.then(l,n._reject);a+=1}return e._done=!0,u._value=u._value-1,0===u._value&&n._resolve.call(t,i),n._promise}function v(e,t,r){for(;e._iterator.next();){var n=e._iterator.getCurrent(),i=r.resolve(n);i.then(t._resolve,t._reject)}return e._done=!0,t._promise}function w(t,r,n,i){f(r)||(r=E.identity),f(n)||(n=E.thrower);var o=new e(i,r),u=new e(i,n);if(t._promiseState===R.pending)t._promiseFulfillReactions.push(o),t._promiseRejectReactions.push(u);else if(t._promiseState===R.fulfilled){var a=t._promiseResult;T.enqueue("PromiseJobs",y,[o,a])}else if(t._promiseState===R.rejected){var s=t._promiseResult;T.enqueue("PromiseJobs",y,[u,s])}return i._promise}function y(r,n){if(r instanceof e){var i=r._capabilities,o=r._handler,u=null,a=null;try{u=o===E.identity?n:o.call(t,n),a=i._resolve(u)}catch(s){a=i._reject.call(t,s)}}}function m(e,r,n){var i=s(e);try{var o=n.call(r,[i._resolve,i._reject])}catch(u){i._reject.call(t,o)}}function b(e,r){var n=e._promiseRejectReactions;return e._promiseResult=r,e._promiseFulfillReactions=t,e._promiseRejectReactions=t,e._promiseState=R.rejected,g(n,r)}function g(e,r){for(var n=0,i=e.length;i>n;n++)T.enqueue("PromiseJobs",y,[e[n],r]);return t}function j(e){if("function"!=typeof e)throw new TypeError("Promise resolver must be function");this._promiseState=R.pending,this._promiseResult=t,this._promiseFulfillReactions=[],this._promiseRejectReactions=[];var r=s(this);try{var n=e.call(t,r._resolve,r._reject)}catch(i){r._reject.call(t,n)}}var R={pending:"pending",fulfilled:"fulfilled",rejected:"rejected"},E={identity:function(e){return e},thrower:function(e){throw e}},x=function(){function e(e){if(this._index=t,!e||"undefined"==typeof e.length)throw new TypeError("Invalid iterable");this.length=(this._iterable=e).length}return e.prototype.next=function(e){return this._index="undefined"!=typeof this._index?this._index+1:0,this._index<this.length},e.prototype.getCurrent=function(){return this._iterable[this._index]},e.prototype.reset=function(){this._index=0},e}(),T=function(){function e(){var e=window.setImmediate&&window.setImmediate.bind(window),t=window.clearImmediate&&window.clearImmediate.bind(window);u.call(this,e,t)}function r(){var e,r;if(window.postMessage&&!window.importScripts){var n=1,i={},o="setImmediate$"+Math.random()+"$";e=function(e){var r=Array.prototype.slice.call(arguments,1);i[n]=function(){"function"==typeof e?e.apply(t,r):new Function(""+e)()};var u=n++;return window.postMessage(o+u,"*"),u},r=function(e){delete i[e]};var a=function(e){if(e.source==window&&"string"==typeof e.data&&0===e.data.indexOf(o)){var t=+e.data.slice(o.length),n=i[t];if(n)try{n()}finally{r(t)}}};window.addEventListener?window.addEventListener("message",a,!1):window.attachEvent("onmessage",a)}u.call(this,e,r)}function n(){var e=window.msSetImmediate&&window.msSetImmediate.bind(window),t=window.msClearImmediate&&window.msClearImmediate.bind(window);u.call(this,e,t)}function i(){var e=window.setTimeout&&window.setTimeout.bind(window),t=window.clearTimeout&&window.clearTimeout.bind(window);u.call(this,e,t)}function o(){this._handlers=[e,n,r,i]}var u=function(e){function t(e,t,r){this.name=e,this.action=t,this.args=r}function r(e,t,r){"undefined"===r&&(r=20),this._run=e,this._clear=t,this._buffer=r,this._queue=new Array(r),this._queueIds=new Array(r),this._length=0}return t.prototype.execute=function(){this.action.apply(e,this.args)},r.prototype.isSupported=function(){return"undefined"!=typeof this._queue&&"undefined"!=typeof this._run&&"undefined"!=typeof this._clear},r.prototype.enqueue=function(e,r,n){if(!this.isSupported())throw new TypeError;if("function"!=typeof r)throw new TypeError("Unexpected action value. Expected type: function");if(null!=typeof n&&("object"!=typeof n||"undefined"==typeof n.length))throw new TypeError("Unexpected args value. Expected type: Array, null or undefined");var i=this._length;this._length=this._length+1,this._queue[i]=new t(e,r,n),this._queueIds[i]=this._run(this._process.bind(this),0)},r.prototype._process=function(){var e=this._queue,t=this._queueIds,r=this._length;this._queue=new Array(this._buffer),this._queueIds=new Array(this._buffer),this._length=0;for(var n=0;r>n;n++)e[n].execute(),this._clear(t[n])},r}();e.prototype=Object.create(u.prototype),r.prototype=Object.create(u.prototype),n.prototype=Object.create(u.prototype),i.prototype=Object.create(u.prototype),o.prototype.createJobHandler=function(){for(var e,t=this._handlers.length,r=0;t>r;r++){var e=new this._handlers[r];if(e.isSupported())return console.log("using jobhandler "+r),e}throw new Error("No job handler supported.")};var a=new o;return a.createJobHandler()}();return j.prototype["catch"]=function(e){return j.prototype.then.call(this,null,e)},j.prototype.then=function(e,t){var r=this;if(!d(r))throw new TypeError("Invalid operation on a promise function");var n=r.constructor,i=_(n);return w(r,e,t,i)},j.all=function(e){var t,r,n,o=this,u=_(o);if(n=p(function(){r=new x(e)},u))return n;var a=new i(r);return(n=p(function(){t=h(a,o,u)},u))?n:t},j.race=function(e){var t,r,n,o=this,u=_(o);if(n=p(function(){r=new x(e)},u))return n;var a=new i(r);return(n=p(function(){t=v(a,u,o)},u))?n:t},j.reject=function(e){var n=this,i=_(n);i._reject.call(t,r);return i._promise},j.resolve=function(e){var r=this;if(d(e)){var n=e.constructor;if(r===n)return e}var i=_(r);i._resolve.call(t,e);return i._promise},j}();e.debugPromise&&(e.PromisePolyfill=n),"undefined"==typeof e.Promise&&(e.Promise=n)}}(window);
